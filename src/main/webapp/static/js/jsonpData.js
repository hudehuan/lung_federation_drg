/**
 * Created by 吴岳峰 on 2017/08/24.
 */
//{"@id":"","cell":[]}
function jsonpDataInit(data) {
    if(data.Message){
        alert(data.Message);
        return;
    }
    if(data.rows==""){
        var rows ={"row":[]};
        data.rows=rows;
    }else if(!data.rows.row.length){
        var row = [data.rows.row];
        data.rows.row=row;
    }
    for(var i=0;i<data.rows.row.length;i++){
        if(Object.prototype.toString.call(data.rows.row[i].cell) !='[object Array]' ){
            data.rows.row[i].cell = [data.rows.row[i].cell];
        }
        for(var j=0;j<data.rows.row[i].cell.length;j++){
            if(Object.prototype.toString.call(data.rows.row[i].cell[j])=='[object Object]'){
                data.rows.row[i].cell[j] = data.rows.row[i].cell[j]['#text'];
            }
            if(data.rows.row[i].cell[j].indexOf("未知[")>-1&&data.rows.row[i].cell[j].indexOf("]")>-1){
                data.rows.row.splice(i,1);
                i--;
                break;
            }
        }
    }
    return data;
}
function initBootstrapTableData(data,dataIndex){
    var title = []; //报表表头
    dataIndex = dataIndex||[];  //数据下标
    var tr ="<tr>";   //表头
    var tableData = [];  //数据

    if(Object.prototype.toString.call(data.title.column)=='[object Array]'){
        title = data.title.column[data.title.column.length-1].split(",");
    }else{
        title = data.title.column.split(",");  //报表表头
    }

    if(dataIndex.length>0){  //数据下标   有值时按下标，空时循环全部
        for(var i=0;i<dataIndex.length;i++){
            if(title[dataIndex[i]]!="#rspan"){
                tr +=" <th data-field='td"+dataIndex[i]+"' data-sortable='true'>"+title[dataIndex[i]]+"</th>";
            }
        }
    }else {
        for(var i=0;i<title.length;i++){
            dataIndex.push(i);
            if(title[dataIndex[i]]!="rspan") {
                tr += " <th data-field='td" + i + "' data-sortable='true'>" + title[dataIndex[i]] + "</th>";
            }
        }
    }
    tr +="</tr>";

    for(var n=0;n<data.rows.row.length;n++){
        var json = {};
        for(var m=0;m<dataIndex.length;m++){
            if(Object.prototype.toString.call(data.rows.row[n].cell[dataIndex[m]])=='[object Object]'&&m<4){
                json['td'+dataIndex[m]] = data.rows.row[n].cell[dataIndex[m]]['#text'];
            }else{
                json['td'+dataIndex[m]] = data.rows.row[n].cell[dataIndex[m]];
            }
        }
        tableData.push(json);
    }
    return {"tr":tr,"data":tableData,"dataIndex":dataIndex};
}
//隐藏加载圈圈
function test(loads) {
    if(loads==0){
        $("#loading").fadeOut("slow");
    }
}
function loadHospitalDat(hospital,year){
    var height = parent.findDimensions_height();
    var width = parent.findDimensions_width();
    parent.layeropen(width*0.95,height*0.9,"","/hubei/V_DrgsJgData/toJgData?hospital="+hospital+"&year="+year);
}
var jsonpTestData =
    {
        "title":{
            "column":"医院名称,门诊费用,门诊人次,门诊次均费用,门诊费用增长率,门诊价格动因,门诊量动因,门诊交互动因,住院费用,出院人次,次均住院费用,住院费用增长率,住院价格动因,住院量动因,住院交互动因,总费用增长率,同期门诊费用,同期门诊人次,同期门诊次均费用,同期住院费用,同期住院人次,同期次均住院费用,门诊价格动因增长量,门诊量动因增长量,门诊交互动因增长量,住院价格动因增长量,住院量动因增长量,住院交互动因增长量,门诊增长量,住院增长量",
            "width":"200,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60",
            "align":"left,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center",
            "type":"ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro",
            "filter":"",
            "targettype":"str,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,str,str,str,str,str,str,int,int",
            "sort":"str,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,str,str,str,str,str,str,int,int",
            "reportmc":"费用动因分析",
            "reportlx":"0",
            "guid":"c241f3a8-2a58-4817-a892-95bc37d12924",
            "mfkxmlopt":{
                "isexpandall":"false",
                "isdelhwdata":"false",
                "orderbycelllx":"2",
                "iscache":"true",
                "orderbycell":"15",
                "iszdxz":"false",
                "isweiqxsql":"false",
                "isdelrow":"false",
                "isiframereport":"false"
            }
        },
        "rows":{
            "row":[
                {
                    "@id":"2B8DCF78-A6E0-4473-A6FC-3291813EC774",
                    "cell":[
                        "山西晋城无烟煤矿业集团有限责任公司总医院",
                        "198256447.83",
                        "600122",
                        "330.36",
                        "11.66",
                        "23.42",
                        "-9.52",
                        "-2.23",
                        "468785578.80",
                        "31484",
                        "14889.64",
                        "28.38",
                        "11.77",
                        "14.86",
                        "1.75",
                        "22.91",
                        "177547089.46",
                        "663295.00",
                        "267.67",
                        "365154757.40",
                        "27410.00",
                        "13321.95",
                        "41581963.55",
                        "-16909516.91",
                        "-3960315.37",
                        "42970382.90",
                        "54273624.30",
                        "6386769.06",
                        "20709358.37",
                        "103630821.40"
                    ]
                },
                {
                    "@id":"DB662E52-38A4-47C8-844E-0CE85373109C",
                    "cell":[
                        "大同市第三人民医院",
                        "199678726.30",
                        "818151",
                        "244.06",
                        "17.04",
                        "9.70",
                        "6.68",
                        "0.65",
                        "438478524.50",
                        "38064",
                        "11519.51",
                        "23.69",
                        "13.74",
                        "8.75",
                        "1.20",
                        "21.53",
                        "170608489.45",
                        "766888.00",
                        "222.47",
                        "354484898.52",
                        "35000.00",
                        "10128.14",
                        "16557111.92",
                        "11404479.61",
                        "1106768.17",
                        "48697950.00",
                        "31032620.96",
                        "4263157.68",
                        "29070236.85",
                        "83993625.98"
                    ]
                },
                {
                    "@id":"596EB4BD-922C-4C41-BC4E-2B6BEE8F7758",
                    "cell":[
                        "忻州市人民医院",
                        "88414228.68",
                        "335331",
                        "263.66",
                        "5.74",
                        "-4.10",
                        "10.26",
                        "-0.42",
                        "317664720.26",
                        "27130",
                        "11708.98",
                        "24.54",
                        "1.26",
                        "22.98",
                        "0.29",
                        "19.90",
                        "83613922.49",
                        "304136.00",
                        "274.92",
                        "255079062.00",
                        "22060.00",
                        "11562.97",
                        "-3424571.36",
                        "8576129.40",
                        "-351255.70",
                        "3220980.60",
                        "58624257.90",
                        "740270.70",
                        "4800306.19",
                        "62585658.26"
                    ]
                },
                {
                    "@id":"3F70A7C3-6FA5-47B1-BAF6-36D6B0DF9009",
                    "cell":[
                        "山西省人民医院",
                        "393131513.55",
                        "1376589",
                        "285.58",
                        "6.81",
                        "1.59",
                        "5.14",
                        "0.08",
                        "1185205076.98",
                        "58552",
                        "20241.92",
                        "19.70",
                        "5.88",
                        "13.05",
                        "0.77",
                        "16.20",
                        "368078358.72",
                        "1309341.00",
                        "281.12",
                        "990186256.92",
                        "51794.00",
                        "19117.78",
                        "5839660.86",
                        "18904757.76",
                        "299926.08",
                        "58223707.16",
                        "129197957.24",
                        "7596938.12",
                        "25053154.83",
                        "195018820.06"
                    ]
                },
                {
                    "@id":"B6A57EBF-0564-4537-ACE0-E47E9BE87BD3",
                    "cell":[
                        "阳泉市第一人民医院",
                        "194640268.51",
                        "844204",
                        "230.56",
                        "10.79",
                        "12.86",
                        "-1.83",
                        "-0.24",
                        "391588095.20",
                        "30166",
                        "12981.11",
                        "17.87",
                        "10.65",
                        "6.52",
                        "0.69",
                        "15.42",
                        "175676942.24",
                        "859972.00",
                        "204.28",
                        "332229766.04",
                        "28320.00",
                        "11731.28",
                        "22600064.16",
                        "-3221087.04",
                        "-414383.04",
                        "35395185.60",
                        "21655942.88",
                        "2307186.18",
                        "18963326.27",
                        "59358329.16"
                    ]
                },
                {
                    "@id":"16506DEA-EEC1-4F4B-AD21-6651C166E314",
                    "cell":[
                        "大同市第五人民医院",
                        "115750882.85",
                        "743670",
                        "155.65",
                        "9.57",
                        "-1.66",
                        "11.43",
                        "-0.19",
                        "454410947.22",
                        "42088",
                        "10796.69",
                        "16.36",
                        "4.41",
                        "11.44",
                        "0.50",
                        "14.92",
                        "105637094.40",
                        "667414.00",
                        "158.28",
                        "390520834.96",
                        "37766.00",
                        "10340.54",
                        "-1755298.82",
                        "12069799.68",
                        "-200553.28",
                        "17226960.90",
                        "44691813.88",
                        "1971480.30",
                        "10113788.45",
                        "63890112.26"
                    ]
                },
                {
                    "@id":"DBF96838-C745-4586-832D-AFD8CA748982",
                    "cell":[
                        "晋中市第一人民医院",
                        "112636743.16",
                        "507254",
                        "222.05",
                        "11.75",
                        "0.99",
                        "10.65",
                        "0.11",
                        "437593905.00",
                        "33292",
                        "13144.12",
                        "13.34",
                        "3.65",
                        "9.35",
                        "0.34",
                        "13.01",
                        "100797504.84",
                        "458426.00",
                        "219.88",
                        "386078504.46",
                        "30446.00",
                        "12680.76",
                        "994784.42",
                        "10736300.64",
                        "105956.76",
                        "14107458.56",
                        "36089442.96",
                        "1318722.56",
                        "11839238.32",
                        "51515400.54"
                    ]
                },
                {
                    "@id":"4DA580E2-DEB0-439F-AFB6-6B111311468F",
                    "cell":[
                        "山西大医院",
                        "410045370.00",
                        "974209",
                        "420.90",
                        "15.24",
                        "5.20",
                        "9.54",
                        "0.50",
                        "1029661689.58",
                        "55610",
                        "18515.76",
                        "10.60",
                        "5.60",
                        "4.73",
                        "0.27",
                        "11.89",
                        "355805816.65",
                        "889327.00",
                        "400.08",
                        "930945215.28",
                        "53096.00",
                        "17533.25",
                        "18515788.14",
                        "33959590.56",
                        "1767243.24",
                        "52167350.96",
                        "44078590.50",
                        "2470030.14",
                        "54239553.35",
                        "98716474.30"
                    ]
                },
                {
                    "@id":"1CC7A8F7-581F-4E6B-91DC-0FD2E9362B31",
                    "cell":[
                        "运城市中心医院",
                        "212081204.50",
                        "700868",
                        "302.60",
                        "10.94",
                        "8.84",
                        "1.93",
                        "0.17",
                        "857491109.10",
                        "63080",
                        "13593.71",
                        "11.67",
                        "6.33",
                        "5.03",
                        "0.32",
                        "11.53",
                        "191169303.14",
                        "687586.00",
                        "278.03",
                        "767845747.82",
                        "60060.00",
                        "12784.64",
                        "16893988.02",
                        "3692794.46",
                        "326338.74",
                        "48592744.20",
                        "38609612.80",
                        "2443391.40",
                        "20911901.36",
                        "89645361.28"
                    ]
                },
                {
                    "@id":"5CEC7CCF-518A-4BFF-83CF-649CB4C487C6",
                    "cell":[
                        "晋城市人民医院",
                        "152562360.36",
                        "529731",
                        "288.00",
                        "13.99",
                        "4.00",
                        "9.60",
                        "0.38",
                        "379267541.98",
                        "31528",
                        "12029.55",
                        "6.97",
                        "-4.49",
                        "12.01",
                        "-0.54",
                        "8.90",
                        "133835225.20",
                        "483310.00",
                        "276.91",
                        "354544186.72",
                        "28148.00",
                        "12595.72",
                        "5359907.90",
                        "12854439.11",
                        "514808.89",
                        "-15936553.16",
                        "42573533.60",
                        "-1913654.60",
                        "18727135.16",
                        "24723355.26"
                    ]
                }
            ]
        }
    }

var jsonpTitlesData =
    {
        "title":{
            "column":[
                "医院名称,平均住院费用,#cspan,#cspan,#cspan,平均住院日,#cspan,#cspan,#cspan,药占比,#cspan,#cspan,#cspan,诊断费占比,#cspan,#cspan,#cspan,耗材费占比,#cspan,#cspan,#cspan",
                "#rspan,基期,报告期,增长量,增长率(%),基期,报告期,增长量,增长率(%),基期,报告期,增长量,增长率(%),基期,报告期,增长量,增长率(%),基期,报告期,增长量,增长率(%)"
            ],
            "width":"200,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60",
            "align":"left,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center,center",
            "type":"ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro,ro",
            "filter":"",
            "targettype":"str,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int",
            "sort":"str,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int,int",
            "reportmc":"",
            "reportlx":"5",
            "guid":"5b0e9b69-fea7-4247-9144-bbaa82510a00",
            "mfkxmlopt":{
                "isdelhwdata":"false",
                "weiplan":"模式一,1,true|模式二,2",
                "isweiqxsql":"false",
                "iscache":"true",
                "isexpandall":"false",
                "iszdxz":"false",
                "isdelrow":"false",
                "isiframereport":"false"
            }
        },
        "rows":{
            "row":[
                {
                    "@id":"4DA580E2-DEB0-439F-AFB6-6B111311468F",
                    "cell":[
                        "山西大医院",
                        "17547.84",
                        "18902.31",
                        "1354.47",
                        "7.72",
                        "10.98",
                        "11.09",
                        "0.11",
                        "1",
                        "35.86",
                        "31",
                        "-4.86",
                        "-13.55",
                        "20.78",
                        "19.24",
                        "-1.54",
                        "-7.41",
                        "22.91",
                        "24.09",
                        "1.18",
                        "5.15"
                    ]
                },
                {
                    "@id":"3F70A7C3-6FA5-47B1-BAF6-36D6B0DF9009",
                    "cell":[
                        "山西省人民医院",
                        "18805.72",
                        "20837.66",
                        "2031.94",
                        "10.8",
                        "9.67",
                        "10.04",
                        "0.37",
                        "3.83",
                        "35.06",
                        "30.17",
                        "-4.89",
                        "-13.95",
                        "20.04",
                        "17.66",
                        "-2.38",
                        "-11.88",
                        "26.15",
                        "27.56",
                        "1.41",
                        "5.39"
                    ]
                },
                {
                    "@id":"DB662E52-38A4-47C8-844E-0CE85373109C",
                    "cell":[
                        "大同市第三人民医院",
                        "9560.28",
                        "10153.72",
                        "593.44",
                        "6.21",
                        "9.85",
                        "9.56",
                        "-0.29",
                        "-2.94",
                        "32.9",
                        "32.08",
                        "-0.82",
                        "-2.49",
                        "23.86",
                        "23.7",
                        "-0.16",
                        "-0.67",
                        "20.26",
                        "21.46",
                        "1.2",
                        "5.92"
                    ]
                },
                {
                    "@id":"16506DEA-EEC1-4F4B-AD21-6651C166E314",
                    "cell":[
                        "大同市第五人民医院",
                        "10327.91",
                        "10385.15",
                        "57.24",
                        "0.55",
                        "10.61",
                        "10.76",
                        "0.15",
                        "1.41",
                        "38.6",
                        "37.96",
                        "-0.64",
                        "-1.66",
                        "26.47",
                        "25.62",
                        "-0.85",
                        "-3.21",
                        "0",
                        "19.09",
                        "19.09",
                        "100"
                    ]
                },
                {
                    "@id":"B6A57EBF-0564-4537-ACE0-E47E9BE87BD3",
                    "cell":[
                        "阳泉市第一人民医院",
                        "12713.49",
                        "13690.22",
                        "976.73",
                        "7.68",
                        "11.13",
                        "11.11",
                        "-0.02",
                        "-0.18",
                        "36.52",
                        "29.67",
                        "-6.85",
                        "-18.76",
                        "28.89",
                        "27.12",
                        "-1.77",
                        "-6.13",
                        "16.31",
                        "20.36",
                        "4.05",
                        "24.83"
                    ]
                },
                {
                    "@id":"5B3D3B93-9773-4EAF-8524-6E544C56013C",
                    "cell":[
                        "阳泉市第三人民医院",
                        "10171.72",
                        "8958.59",
                        "-1213.13",
                        "-11.93",
                        "13.04",
                        "12.51",
                        "-0.53",
                        "-4.06",
                        "44.31",
                        "41.64",
                        "-2.67",
                        "-6.03",
                        "22.73",
                        "23.18",
                        "0.45",
                        "1.98",
                        "13.04",
                        "10.69",
                        "-2.35",
                        "-18.02"
                    ]
                },
                {
                    "@id":"E45EC815-81FB-43FF-B82D-0DFAD6F54F20",
                    "cell":[
                        "长治市人民医院",
                        "10596.15",
                        "7981.35",
                        "-2614.8",
                        "-24.68",
                        "9.97",
                        "9.39",
                        "-0.58",
                        "-5.82",
                        "33.44",
                        "33.12",
                        "-0.32",
                        "-0.96",
                        "25.52",
                        "10.07",
                        "-15.45",
                        "-60.54",
                        "15.29",
                        "22.3",
                        "7.01",
                        "45.85"
                    ]
                },
                {
                    "@id":"DEE9CEA1-E430-4F16-ADAE-74BB5A743DC2",
                    "cell":[
                        "长治市第二人民医院",
                        "10675.3",
                        "10842.74",
                        "167.44",
                        "1.57",
                        "13.68",
                        "13.09",
                        "-0.59",
                        "-4.31",
                        "37.71",
                        "31.12",
                        "-6.59",
                        "-17.48",
                        "17.69",
                        "18.39",
                        "0.7",
                        "3.96",
                        "24.59",
                        "27.68",
                        "3.09",
                        "12.57"
                    ]
                },
                {
                    "@id":"5CEC7CCF-518A-4BFF-83CF-649CB4C487C6",
                    "cell":[
                        "晋城市人民医院",
                        "12022.1",
                        "12494.9",
                        "472.8",
                        "3.93",
                        "10.3",
                        "9.76",
                        "-0.54",
                        "-5.24",
                        "35.89",
                        "34.89",
                        "-1",
                        "-2.79",
                        "24.41",
                        "24.96",
                        "0.55",
                        "2.25",
                        "20.75",
                        "21.98",
                        "1.23",
                        "5.93"
                    ]
                },
                {
                    "@id":"2B8DCF78-A6E0-4473-A6FC-3291813EC774",
                    "cell":[
                        "山西晋城无烟煤矿业集团有限责任公司总医院",
                        "12780.8",
                        "14463.97",
                        "1683.17",
                        "13.17",
                        "10.85",
                        "10.71",
                        "-0.14",
                        "-1.29",
                        "38.05",
                        "39.15",
                        "1.1",
                        "2.89",
                        "16.17",
                        "16.03",
                        "-0.14",
                        "-0.87",
                        "29",
                        "28.69",
                        "-0.31",
                        "-1.07"
                    ]
                }]}}